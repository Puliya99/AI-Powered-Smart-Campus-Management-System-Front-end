import{r as n,b as y,j as e,a as B,z as m,u as R}from"./index-Cv_EM5B3.js";import{X as U,B as $,F as z,D as V,S as H}from"./DashboardLayout-Dgk-_yJ3.js";import{S as G}from"./save-BnGpkhwG.js";import{U as J}from"./user-AQ183lw-.js";import{P as E}from"./phone-gSTUTTg8.js";import{M as O}from"./mail-DSG3J4YO.js";import{C as q}from"./clock-YOqg-tzx.js";import{M as X}from"./map-pin-DPFV6g1q.js";import{B as _}from"./building-DE96Jm2V.js";import{H as K}from"./hash-BFl_i1Z-.js";import{C as Q}from"./check-circle-C2ph5B4V.js";import{a as W}from"./credit-card-DXrYcg-6.js";import{U as Y}from"./user-plus-DtxWCNpf.js";import{U as M}from"./video-D6oD5f21.js";import{E as Z}from"./eye-WupJDer2.js";import{P as ee}from"./pen-square-BIqX7x5-.js";import{T as se}from"./trash-2-CpS1ADUT.js";import"./graduation-cap-DFyTfTku.js";const te=({isOpen:b,onClose:o,student:a,onSuccess:k})=>{const[j,r]=n.useState(!1),[T,h]=n.useState([]),[p,g]=n.useState([]),[v,S]=n.useState([]),[t,c]=n.useState({username:"",email:"",password:"",title:"Mr",firstName:"",lastName:"",gender:"MALE",dateOfBirth:"",nic:"",address:"",mobileNumber:"",homeNumber:"",paymentType:"FULL",centerId:"",programId:"",batchId:""});n.useEffect(()=>{w()},[]);const w=async()=>{try{const[l,d,u]=await Promise.all([y.get("/centers/dropdown"),y.get("/programs/dropdown"),y.get("/batches/dropdown")]);h(l.data.data.centers),g(d.data.data.programs),S(u.data.data.batches)}catch(l){console.error("Failed to fetch selection data",l)}};n.useEffect(()=>{var l,d,u,f,C,A,L,P;c(a?{username:a.user.username||"",email:a.user.email||"",password:"",title:a.user.title||"Mr",firstName:a.user.firstName||"",lastName:a.user.lastName||"",gender:a.user.gender||"MALE",dateOfBirth:((l=a.user.dateOfBirth)==null?void 0:l.split("T")[0])||"",nic:a.user.nic||"",address:a.user.address||"",mobileNumber:a.user.mobileNumber||"",homeNumber:a.user.homeNumber||"",paymentType:a.paymentType||"FULL",centerId:((d=a.user.center)==null?void 0:d.id)||"",programId:((C=(f=(u=a.enrollments)==null?void 0:u[0])==null?void 0:f.program)==null?void 0:C.id)||"",batchId:((P=(L=(A=a.enrollments)==null?void 0:A[0])==null?void 0:L.batch)==null?void 0:P.id)||""}:{username:"",email:"",password:"",title:"Mr",firstName:"",lastName:"",gender:"MALE",dateOfBirth:"",nic:"",address:"",mobileNumber:"",homeNumber:"",paymentType:"FULL",centerId:"",programId:"",batchId:""})},[a]);const i=l=>{const{name:d,value:u}=l.target;if(d==="programId")c({...t,[d]:u,batchId:""});else if(d==="batchId"){const f=v.find(C=>C.id===u);f&&f.program?c({...t,[d]:u,programId:f.program.id}):c({...t,[d]:u})}else c({...t,[d]:u})},I=()=>t.firstName.trim()?t.lastName.trim()?!t.email.trim()||!t.email.includes("@")?(m.error("Valid email is required"),!1):!t.username.trim()||t.username.length<3?(m.error("Username must be at least 3 characters"),!1):!a&&(!t.password||t.password.length<8)?(m.error("Password must be at least 8 characters"),!1):t.mobileNumber.trim()?t.nic.trim()?!a&&!t.centerId?(m.error("Center is required"),!1):!a&&!t.programId?(m.error("Program is required"),!1):!a&&!t.batchId?(m.error("Batch is required"),!1):!0:(m.error("NIC is required"),!1):(m.error("Mobile number is required"),!1):(m.error("Last name is required"),!1):(m.error("First name is required"),!1),x=async l=>{var d,u;if(l.preventDefault(),!!I()){r(!0);try{a?(await y.put(`/students/${a.id}`,{user:{title:t.title,firstName:t.firstName,lastName:t.lastName,email:t.email,gender:t.gender,dateOfBirth:t.dateOfBirth,nic:t.nic,address:t.address,mobileNumber:t.mobileNumber,homeNumber:t.homeNumber,center:t.centerId?{id:t.centerId}:null},paymentType:t.paymentType,centerId:t.centerId,programId:t.programId,batchId:t.batchId}),m.success("Student updated successfully")):(await y.post("/students",t),m.success("Student created successfully")),k(),o()}catch(f){m.error(((u=(d=f.response)==null?void 0:d.data)==null?void 0:u.message)||`Failed to ${a?"update":"create"} student`)}finally{r(!1)}}};if(!b)return null;const D=v.filter(l=>{var d;return t.programId?((d=l.program)==null?void 0:d.id)===t.programId:!0});return e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:o}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-primary-600 px-6 py-4 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:a?"Edit Student":"Add New Student"}),e.jsx("button",{onClick:o,className:"text-white hover:text-gray-200 transition",children:e.jsx(U,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:x,children:[e.jsx("div",{className:"bg-white px-6 py-5 max-h-[calc(100vh-200px)] overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Personal Information"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"title",value:t.title,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"Mr",children:"Mr"}),e.jsx("option",{value:"Ms",children:"Ms"}),e.jsx("option",{value:"Mrs",children:"Mrs"}),e.jsx("option",{value:"Dr",children:"Dr"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"firstName",value:t.firstName,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"John"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"lastName",value:t.lastName,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Doe"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Gender ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"gender",value:t.gender,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"MALE",children:"Male"}),e.jsx("option",{value:"FEMALE",children:"Female"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Date of Birth ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"dateOfBirth",value:t.dateOfBirth,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsx("div",{className:"md:col-span-2 mt-4",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Account Information"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"username",value:t.username,onChange:i,required:!0,disabled:!!a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:bg-gray-100",placeholder:"johndoe"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"john.doe@example.com"})]}),!a&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",name:"password",value:t.password,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Minimum 8 characters"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Payment Type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"paymentType",value:t.paymentType,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"FULL",children:"Full Payment"}),e.jsx("option",{value:"INSTALLMENT",children:"Installment"})]})]}),e.jsx("div",{className:"md:col-span-2 mt-4",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Academic Information"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Center ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"centerId",value:t.centerId,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Center"}),T.map(l=>e.jsx("option",{value:l.id,children:l.centerName},l.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Program ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"programId",value:t.programId,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Program"}),p.map(l=>e.jsx("option",{value:l.id,children:l.programName},l.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Batch ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"batchId",value:t.batchId,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Batch"}),D.map(l=>e.jsx("option",{value:l.id,children:l.batchNumber},l.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["NIC ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"nic",value:t.nic,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"123456789V"})]}),e.jsx("div",{className:"md:col-span-2 mt-4",children:e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4 border-b pb-2",children:"Contact Information"})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Mobile Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",name:"mobileNumber",value:t.mobileNumber,onChange:i,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0771234567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Home Number"}),e.jsx("input",{type:"tel",name:"homeNumber",value:t.homeNumber,onChange:i,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"0112345678"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"address",value:t.address,onChange:i,required:!0,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter full address"})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:o,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition",disabled:j,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition disabled:opacity-50",children:j?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-5 h-5 mr-2 animate-spin"}),a?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),a?"Update Student":"Create Student"]})})]})]})]})]})})},re=({isOpen:b,onClose:o,studentId:a})=>{var p,g,v,S,t;const[k,j]=n.useState(!1),[r,T]=n.useState(null);n.useEffect(()=>{b&&a&&h()},[b,a]);const h=async()=>{try{j(!0);const c=await y.get(`/students/${a}`);T(c.data.data.student)}catch{m.error("Failed to fetch student details"),o()}finally{j(!1)}};return b?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:o}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-primary-600 px-6 py-4 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Student Details"}),e.jsx("button",{onClick:o,className:"text-white hover:text-gray-200 transition",children:e.jsx(U,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"bg-white px-6 py-5 max-h-[calc(100vh-200px)] overflow-y-auto",children:k?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(B,{className:"w-12 h-12 text-primary-600 animate-spin"})}):r?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start space-y-4 md:space-y-0 md:space-x-6 pb-6 border-b",children:[e.jsxs("div",{className:"w-24 h-24 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 text-3xl font-bold",children:[r.user.firstName.charAt(0),r.user.lastName.charAt(0)]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[r.user.title," ",r.user.firstName," ",r.user.lastName]}),e.jsx("p",{className:"text-gray-500 font-medium",children:r.universityNumber}),e.jsxs("div",{className:"mt-2 flex flex-wrap justify-center md:justify-start gap-2",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${r.user.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.user.isActive?"Active":"Inactive"}),e.jsx("span",{className:"px-3 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Student"}),e.jsxs("span",{className:"px-3 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:[r.paymentType," Payment"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(J,{className:"w-5 h-5 mr-2 text-primary-600"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"NIC:"}),e.jsx("span",{className:"text-gray-900",children:r.user.nic})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"Gender:"}),e.jsx("span",{className:"text-gray-900 capitalize",children:r.user.gender.toLowerCase()})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"Date of Birth:"}),e.jsx("span",{className:"text-gray-900",children:new Date(r.user.dateOfBirth).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"Joined:"}),e.jsx("span",{className:"text-gray-900",children:new Date(r.user.createdAt).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(E,{className:"w-5 h-5 mr-2 text-primary-600"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:r.user.email})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(E,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:r.user.mobileNumber})]}),r.user.homeNumber&&e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(q,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:r.user.homeNumber})]}),e.jsxs("div",{className:"flex items-start text-sm",children:[e.jsx(X,{className:"w-4 h-4 mr-2 mt-0.5 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:r.user.address})]})]})]}),e.jsxs("div",{className:"space-y-4 md:col-span-2",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2 text-primary-600"}),"Academic & Enrollment Information"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(_,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"Center:"}),e.jsx("span",{className:"text-gray-900",children:((p=r.user.center)==null?void 0:p.centerName)||"N/A"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(K,{className:"w-4 h-4 mr-2 text-gray-400"}),e.jsx("span",{className:"text-gray-500 w-32 font-medium",children:"Reg No:"}),e.jsx("span",{className:"text-gray-900",children:r.user.registrationNumber})]})]}),r.enrollments&&r.enrollments.length>0?e.jsx("div",{className:"mt-4 border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Program"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Batch"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:r.enrollments.map(c=>{var w,i;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-gray-900",children:(w=c.program)==null?void 0:w.programName}),e.jsx("td",{className:"px-4 py-2 text-gray-900",children:(i=c.batch)==null?void 0:i.batchNumber}),e.jsx("td",{className:"px-4 py-2 text-gray-500",children:new Date(c.enrollmentDate).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${c.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:c.status})})]},c.id)})})]})}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No enrollments found."})]}),e.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 md:grid-cols-4 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-center",children:[e.jsx(Q,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Attendance"}),e.jsx("p",{className:"text-lg font-bold text-blue-900",children:((g=r.attendances)==null?void 0:g.length)||0})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center",children:[e.jsx(W,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Payments"}),e.jsx("p",{className:"text-lg font-bold text-green-900",children:((v=r.payments)==null?void 0:v.length)||0})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg text-center",children:[e.jsx(z,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),e.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Assignments"}),e.jsx("p",{className:"text-lg font-bold text-purple-900",children:((S=r.assignments)==null?void 0:S.length)||0})]}),e.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg text-center",children:[e.jsx(q,{className:"w-5 h-5 mx-auto text-orange-600 mb-1"}),e.jsx("p",{className:"text-xs text-orange-600 font-medium",children:"Results"}),e.jsx("p",{className:"text-lg font-bold text-orange-900",children:((t=r.results)==null?void 0:t.length)||0})]})]})]})]}):e.jsx("div",{className:"text-center py-20 text-gray-500",children:"Student not found."})}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end",children:e.jsx("button",{onClick:o,className:"px-6 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 transition",children:"Close"})})]})]})}):null},ve=()=>{const{user:b}=R(),[o,a]=n.useState([]),[k,j]=n.useState(!0),[r,T]=n.useState(""),[h,p]=n.useState(1),[g,v]=n.useState(1),[S,t]=n.useState(!1),[c,w]=n.useState(!1),[i,I]=n.useState(null),[x,D]=n.useState({paymentType:"",isActive:"",centerId:"",batchId:""}),[l,d]=n.useState([]),[u,f]=n.useState([]);n.useEffect(()=>{A()},[h,r,x]),n.useEffect(()=>{C()},[]);const C=async()=>{try{const[s,N]=await Promise.all([y.get("/centers/dropdown"),y.get("/batches/dropdown")]);d(s.data.data.centers),f(N.data.data.batches)}catch(s){console.error("Failed to fetch filter data",s)}},A=async()=>{try{j(!0);const s=new URLSearchParams({page:h.toString(),limit:"10",...r&&{search:r},...x.paymentType&&{paymentType:x.paymentType},...x.isActive&&{isActive:x.isActive},...x.centerId&&{centerId:x.centerId},...x.batchId&&{batchId:x.batchId}}),N=await y.get(`/students?${s}`);a(N.data.data.students),v(N.data.data.pagination.pages)}catch(s){m.error("Failed to fetch students"),console.error(s)}finally{j(!1)}},L=async s=>{if(window.confirm("Are you sure you want to deactivate this student?"))try{await y.delete(`/students/${s}`),m.success("Student deactivated successfully"),A()}catch{m.error("Failed to deactivate student")}},P=s=>{T(s.target.value),p(1)},F=(s,N)=>{D({...x,[s]:N}),p(1)};return e.jsxs(V,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Students"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage student records"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition",children:[e.jsx(Y,{className:"w-5 h-5 mr-2"}),"Add Student"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-5 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold",children:o.length})]}),e.jsx(M,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-5 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:o.filter(s=>s.user.isActive).length})]}),e.jsx(M,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-5 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Full Payment"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:o.filter(s=>s.paymentType==="FULL").length})]}),e.jsx(M,{className:"w-10 h-10 text-purple-500"})]})}),e.jsx("div",{className:"bg-white p-5 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Installment"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:o.filter(s=>s.paymentType==="INSTALLMENT").length})]}),e.jsx(M,{className:"w-10 h-10 text-orange-500"})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",value:r,onChange:P,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})}),(b==null?void 0:b.role)==="ADMIN"&&e.jsxs("select",{value:x.centerId,onChange:s=>F("centerId",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Centers"}),l.map(s=>e.jsx("option",{value:s.id,children:s.centerName},s.id))]}),e.jsxs("select",{value:x.batchId,onChange:s=>F("batchId",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Batches"}),u.map(s=>e.jsx("option",{value:s.id,children:s.batchNumber},s.id))]}),e.jsxs("select",{value:x.paymentType,onChange:s=>F("paymentType",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Payment Types"}),e.jsx("option",{value:"FULL",children:"Full Payment"}),e.jsx("option",{value:"INSTALLMENT",children:"Installment"})]}),e.jsxs("select",{value:x.isActive,onChange:s=>F("isActive",s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:k?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No students found"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University No."}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white font-semibold",children:[s.user.firstName.charAt(0),s.user.lastName.charAt(0)]}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:s.user.registrationNumber})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.universityNumber})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900 flex items-center",children:[e.jsx(O,{className:"w-4 h-4 mr-1 text-gray-400"}),s.user.email]}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-1 text-gray-400"}),s.user.mobileNumber]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s.paymentType==="FULL"?"bg-purple-100 text-purple-800":"bg-orange-100 text-orange-800"}`,children:s.paymentType})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${s.user.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.user.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{I(s),w(!0)},className:"text-blue-600 hover:text-blue-900",title:"View",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{I(s),t(!0)},className:"text-green-600 hover:text-green-900",title:"Edit",children:e.jsx(ee,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>L(s.id),className:"text-red-600 hover:text-red-900",title:"Delete",children:e.jsx(se,{className:"w-5 h-5"})})]})})]},s.id))})]})}),e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>p(s=>Math.max(1,s-1)),disabled:h===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>p(s=>Math.min(g,s+1)),disabled:h===g,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Page ",e.jsx("span",{className:"font-medium",children:h})," of"," ",e.jsx("span",{className:"font-medium",children:g})]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>p(s=>Math.max(1,s-1)),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),Array.from({length:Math.min(5,g)},(s,N)=>N+1).map(s=>e.jsx("button",{onClick:()=>p(s),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${h===s?"z-10 bg-primary-50 border-primary-500 text-primary-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:s},s)),e.jsx("button",{onClick:()=>p(s=>Math.min(g,s+1)),disabled:h===g,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})})]})]})]})})]}),e.jsx(te,{isOpen:S,onClose:()=>{t(!1),I(null)},student:i,onSuccess:A}),e.jsx(re,{isOpen:c,onClose:()=>{w(!1),I(null)},studentId:(i==null?void 0:i.id)||null})]})};export{ve as default};
