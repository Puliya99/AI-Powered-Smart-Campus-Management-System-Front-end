import{e as g,r as n,j as e,z as m,b as y,c as G,u as X,d as $,L as q}from"./index-Cv_EM5B3.js";import{X as K,F as L,D as E,e as T,C as O}from"./DashboardLayout-Dgk-_yJ3.js";import{A as U}from"./arrow-left-DFjmxUWB.js";import{P as F}from"./plus-smBCJEhq.js";import{T as z}from"./trash-2-CpS1ADUT.js";import{U as B}from"./user-AQ183lw-.js";import{E as H}from"./external-link-Cw5RVrh2.js";import{D as V}from"./download-C72kMWMo.js";import"./graduation-cap-DFyTfTku.js";import"./credit-card-DXrYcg-6.js";import"./video-D6oD5f21.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=g("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=g("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=g("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=g("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=g("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),J=({isOpen:l,onClose:o,moduleId:b,onSuccess:j})=>{const[x,u]=n.useState(!1),[s,d]=n.useState({title:"",type:"FILE",content:"",fileUrl:""}),[i,h]=n.useState(null),f=n.useRef(null),N=r=>{r.target.files&&r.target.files[0]&&h(r.target.files[0])},v=async r=>{var w,k;if(r.preventDefault(),!s.title)return m.error("Title is required");try{u(!0);const a=new FormData;if(a.append("title",s.title),a.append("type",s.type),a.append("moduleId",b),s.type==="TEXT"||s.type==="LINK")a.append("content",s.content);else if(i)a.append("file",i);else if(s.fileUrl)a.append("fileUrl",s.fileUrl);else return u(!1),m.error("Please select a file or provide a URL");await y.post("/lecture-notes",a,{headers:{"Content-Type":"multipart/form-data"}}),m.success("Material shared successfully"),j(),o()}catch(a){m.error(((k=(w=a.response)==null?void 0:w.data)==null?void 0:k.message)||"Failed to share material")}finally{u(!1)}};return l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between bg-primary-600",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Share Lecture Material"}),e.jsx("button",{onClick:o,className:"text-white hover:text-gray-200 transition-colors",children:e.jsx(K,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all",placeholder:"Enter material title...",value:s.title,onChange:r=>d({...s,title:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material Type"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[{id:"TEXT",icon:L,label:"Text"},{id:"IMAGE",icon:C,label:"Image"},{id:"LINK",icon:S,label:"Link"},{id:"FILE",icon:M,label:"File"}].map(r=>e.jsxs("button",{type:"button",onClick:()=>{d({...s,type:r.id}),h(null)},className:`flex flex-col items-center p-3 rounded-lg border-2 transition-all ${s.type===r.id?"border-primary-600 bg-primary-50 text-primary-600":"border-gray-100 bg-gray-50 text-gray-500 hover:border-gray-200"}`,children:[e.jsx(r.icon,{className:"h-6 w-6 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:r.label})]},r.id))})]}),s.type==="TEXT"||s.type==="LINK"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.type==="TEXT"?"Content":"Link URL"}),e.jsx("textarea",{required:!0,rows:s.type==="TEXT"?4:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all",placeholder:s.type==="TEXT"?"Enter text content...":"https://example.com/resource",value:s.content,onChange:r=>d({...s,content:r.target.value})})]}):null,s.type!=="TEXT"&&s.type!=="LINK"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Upload ",s.type==="IMAGE"?"Image":"File"]}),e.jsx("div",{onClick:()=>{var r;return(r=f.current)==null?void 0:r.click()},className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer hover:border-primary-500 hover:bg-gray-50 transition-all",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(_,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("div",{className:"flex text-sm text-gray-600",children:e.jsx("span",{className:"relative rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none",children:i?i.name:`Upload a ${s.type.toLowerCase()}`})}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, PDF, DOC up to 5MB"})]})}),e.jsx("input",{type:"file",ref:f,className:"hidden",accept:s.type==="IMAGE"?"image/*":".pdf,.doc,.docx",onChange:N})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"OR"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.type==="IMAGE"?"Image URL":"File URL"}),e.jsx("input",{type:"url",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-all",placeholder:"https://example.com/file.pdf",value:s.fileUrl,disabled:!!i,onChange:r=>d({...s,fileUrl:r.target.value})}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Provide a public URL if you don't want to upload a file."})]})]}):null,s.type==="IMAGE"&&(i||s.fileUrl)&&e.jsx("div",{className:"mt-2 border rounded-lg overflow-hidden bg-gray-50",children:e.jsx("img",{src:i?URL.createObjectURL(i):s.fileUrl,alt:"Preview",className:"max-h-32 mx-auto object-contain",onError:r=>r.currentTarget.src="https://via.placeholder.com/150?text=Invalid+Image+URL"})}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center justify-center disabled:opacity-50",children:x?e.jsx("div",{className:"h-5 w-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-5 w-5 mr-2"}),"Share"]})})]})]})]})}):null},oe=()=>{const{moduleId:l}=G(),{user:o}=X(),[b,j]=n.useState([]),[x,u]=n.useState(null),[s,d]=n.useState(!0),[i,h]=n.useState(!1),[f,N]=n.useState([]),v=$(),r=(o==null?void 0:o.role)==="LECTURER";n.useEffect(()=>{o&&w()},[o]),n.useEffect(()=>{l?(k(),a()):(u(null),j([]),d(!1))},[l]);const w=async()=>{try{if(r){const t=await y.get("/lecturers/profile/me");N(t.data.data.lecturer.modules||[])}else{const t=await y.get("/dashboard/student");N(t.data.data.enrolledModules||[])}}catch(t){console.error("Failed to fetch available modules:",t)}},k=async()=>{if(l)try{const t=await y.get(`/modules/${l}`);u(t.data.data.module)}catch(t){console.error("Failed to fetch module details:",t)}},a=async()=>{var t,c;if(l)try{d(!0);const p=await y.get(`/lecture-notes/module/${l}`);j(p.data.data.materials)}catch(p){m.error(((c=(t=p.response)==null?void 0:t.data)==null?void 0:c.message)||"Failed to fetch materials")}finally{d(!1)}},D=async t=>{var c,p;if(window.confirm("Are you sure you want to delete this material?"))try{await y.delete(`/lecture-notes/${t}`),m.success("Material deleted successfully"),a()}catch(P){m.error(((p=(c=P.response)==null?void 0:c.data)==null?void 0:p.message)||"Failed to delete material")}},R=t=>{switch(t){case"TEXT":return e.jsx(L,{className:"h-6 w-6 text-blue-500"});case"IMAGE":return e.jsx(C,{className:"h-6 w-6 text-green-500"});case"LINK":return e.jsx(S,{className:"h-6 w-6 text-purple-500"});case"FILE":return e.jsx(M,{className:"h-6 w-6 text-orange-500"});default:return e.jsx(M,{className:"h-6 w-6 text-gray-500"})}},A=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),I=t=>{const c=t.target.value;v(c?r?`/lecturer/modules/${c}/materials`:`/student/modules/${c}/materials`:r?"/lecturer/materials":"/student/materials")};return l?e.jsxs(E,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center text-sm text-gray-500 hover:text-primary-600",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("div",{className:"relative inline-block",children:[e.jsx("select",{className:"bg-transparent border-none text-sm text-primary-600 font-medium focus:ring-0 p-0 pr-8 appearance-none cursor-pointer hover:text-primary-700",onChange:I,value:l,children:f.map(t=>e.jsx("option",{value:t.id,children:t.moduleCode},t.id))}),e.jsx(T,{className:"h-3 w-3 absolute right-2 top-1/2 -translate-y-1/2 text-primary-600 pointer-events-none"})]})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lecture Materials"}),x&&e.jsxs("p",{className:"text-gray-600",children:[x.moduleCode," - ",x.moduleName]})]}),r&&e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Share Material"]})]}),s?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):b.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:b.map(t=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow flex flex-col",children:[e.jsxs("div",{className:"p-5 flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg",children:R(t.type)}),r&&e.jsx("button",{onClick:()=>D(t.id),className:"text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(z,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 line-clamp-2",children:t.title}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),t.lecturer.user.firstName," ",t.lecturer.user.lastName]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(O,{className:"h-3 w-3 mr-1"}),A(t.uploadDate)]})]})]}),t.type==="TEXT"&&t.content&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg text-sm text-gray-600 line-clamp-3 italic",children:t.content})]}),e.jsx("div",{className:"px-5 py-4 bg-gray-50 border-t border-gray-200",children:t.type==="LINK"?e.jsxs("a",{href:t.content,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-primary-600 bg-white border border-primary-600 rounded-lg hover:bg-primary-50 transition-colors",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Open Link"]}):t.fileUrl?e.jsx("a",{href:t.fileUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-primary-600 bg-white border border-primary-600 rounded-lg hover:bg-primary-50 transition-colors",children:t.type==="IMAGE"?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"View Image"]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Download File"]})}):e.jsx("div",{className:"text-center text-sm text-gray-500 py-2",children:"No attachment"})})]},t.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border-2 border-dashed border-gray-300",children:[e.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No materials found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:r?"You haven't shared any materials for this module yet.":"Your lecturer hasn't shared any materials for this module yet."}),r&&e.jsxs("button",{onClick:()=>h(!0),className:"mt-4 inline-flex items-center text-primary-600 font-medium hover:text-primary-700",children:[e.jsx(F,{className:"h-4 w-4 mr-1"}),"Share your first material"]})]})]}),i&&e.jsx(J,{isOpen:i,onClose:()=>h(!1),moduleId:l,onSuccess:a})]}):e.jsx(E,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center text-sm text-gray-500 hover:text-primary-600 mb-2",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Lecture Materials"}),e.jsx("p",{className:"text-gray-600",children:"Please select a module to view materials."})]})}),e.jsxs("div",{className:"max-w-md mx-auto bg-white p-8 rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"p-3 bg-primary-50 rounded-full inline-block mb-4",children:e.jsx(L,{className:"h-8 w-8 text-primary-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Select a Module"}),e.jsx("p",{className:"text-gray-500 mt-1 text-sm",children:"Choose one of your assigned modules to view its materials."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{className:"block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-lg appearance-none bg-white border cursor-pointer",onChange:I,value:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a module..."}),f.map(t=>e.jsxs("option",{value:t.id,children:[t.moduleCode," - ",t.moduleName]},t.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-400",children:e.jsx(T,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:"OR"})}),e.jsxs(q,{to:r?"/lecturer/classes":"/student/courses",className:"flex items-center justify-center w-full px-4 py-2 text-sm font-medium text-primary-600 bg-white border border-primary-600 rounded-lg hover:bg-primary-50 transition-colors",children:["Go to My ",r?"Classes":"Courses"]})]})]})]})})};export{oe as default};
