import{e as u,b as p,r as i,j as e,a as N,z as y,u as b}from"./index-Cv_EM5B3.js";import{F as v,D as S,B as R,a as D}from"./DashboardLayout-Dgk-_yJ3.js";import{D as g}from"./download-C72kMWMo.js";import{U as k}from"./video-D6oD5f21.js";import"./graduation-cap-DFyTfTku.js";import"./credit-card-DXrYcg-6.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=u("FileBarChart",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-4",key:"q1q25u"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M16 18v-6",key:"15y0np"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=u("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=u("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),x={getEnrollmentReport:async s=>{const a=new URLSearchParams;return s&&a.append("centerId",s),(await p.get(`/reports/enrollment?${a.toString()}`)).data},getPaymentReport:async(s,a,n)=>{const l=new URLSearchParams;return s&&l.append("startDate",s),a&&l.append("endDate",a),n&&l.append("centerId",n),(await p.get(`/reports/payment?${l.toString()}`)).data},getAttendanceReport:async(s,a)=>{const n=new URLSearchParams;return s&&n.append("batchId",s),a&&n.append("centerId",a),(await p.get(`/reports/attendance?${n.toString()}`)).data},getReportStats:async s=>{const a=new URLSearchParams;return s&&a.append("centerId",s),(await p.get(`/reports/stats?${a.toString()}`)).data}},B=({onReportGenerated:s,selectedCenter:a})=>{const[n,l]=i.useState(!1),[t,m]=i.useState("enrollment"),[c,o]=i.useState({startDate:"",endDate:"",batchId:""}),h=async()=>{l(!0);try{let r;switch(t){case"enrollment":r=await x.getEnrollmentReport(a);break;case"payment":r=await x.getPaymentReport(c.startDate,c.endDate,a);break;case"attendance":r=await x.getAttendanceReport(c.batchId,a);break;default:throw new Error("Invalid report type")}s(t,r.data),y.success("Report generated successfully")}catch(r){y.error(r.message||"Failed to generate report")}finally{l(!1)}};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[e.jsx(v,{className:"w-5 h-5 mr-2 text-primary-600"}),"Generate Report"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Type"}),e.jsxs("select",{value:t,onChange:r=>m(r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"enrollment",children:"Enrollment Report"}),e.jsx("option",{value:"payment",children:"Payment Report"}),e.jsx("option",{value:"attendance",children:"Attendance Report"})]})]}),t==="payment"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:c.startDate,onChange:r=>o({...c,startDate:r.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:c.endDate,onChange:r=>o({...c,endDate:r.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),t==="attendance"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch ID (Optional)"}),e.jsx("input",{type:"text",placeholder:"Enter Batch ID",value:c.batchId,onChange:r=>o({...c,batchId:r.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),e.jsx("button",{onClick:h,disabled:n,className:"mt-6 flex items-center justify-center w-full md:w-auto px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-5 h-5 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"w-5 h-5 mr-2"}),"Generate Report"]})})]})},E=({type:s,data:a})=>{if(!a||a.length===0)return e.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md text-center text-gray-500",children:"No data available for the selected report."});const n=()=>{switch(s){case"enrollment":return e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Program"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.student.user.firstName," ",t.student.user.lastName]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.batch.program.programName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.batch.batchName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(t.enrollmentDate).toLocaleDateString()})]},t.id))})]});case"payment":return e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.student.user.firstName," ",t.student.user.lastName]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:["LKR ",t.amount]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.paymentMethod}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.status}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(t.paymentDate).toLocaleDateString()})]},t.id))})]});case"attendance":return e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Batch"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Module"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[t.student.user.firstName," ",t.student.user.lastName]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.schedule.batch.batchName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.schedule.module.moduleName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.status}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(t.date).toLocaleDateString()})]},t.id))})]});default:return null}},l=()=>{window.print()};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold capitalize",children:[s," Report Preview"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:l,className:"flex items-center px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Print"]}),e.jsxs("button",{className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition",children:[e.jsx(g,{className:"w-4 h-4 mr-2"}),"Export CSV"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:n()})]})},U=()=>{const{user:s}=b(),[a,n]=i.useState(null),[l,t]=i.useState(""),[m,c]=i.useState([]),[o,h]=i.useState({totalStudents:0,totalPrograms:0,totalBatches:0,totalRevenue:0});i.useEffect(()=>{r()},[]),i.useEffect(()=>{j()},[l]);const r=async()=>{try{const d=await p.get("/centers");c(d.data.data.centers||[])}catch(d){console.error("Failed to fetch centers:",d)}},j=async()=>{try{const d=await x.getReportStats(l);h(d.data)}catch(d){console.error("Failed to fetch stats:",d)}},f=(d,w)=>{n({type:d,data:w})};return e.jsx(S,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Generate and view campus reports"})]}),(s==null?void 0:s.role)==="ADMIN"&&e.jsx("div",{className:"w-full md:w-64",children:e.jsxs("select",{value:l,onChange:d=>t(d.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Centers"}),m.map(d=>e.jsx("option",{value:d.id,children:d.centerName},d.id))]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.totalStudents})]}),e.jsx(k,{className:"w-10 h-10 text-blue-100"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Programs"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.totalPrograms})]}),e.jsx(R,{className:"w-10 h-10 text-green-100"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Batches"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.totalBatches})]}),e.jsx(P,{className:"w-10 h-10 text-purple-100"})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["LKR ",o.totalRevenue.toLocaleString()]})]}),e.jsx(D,{className:"w-10 h-10 text-yellow-100"})]})})]}),e.jsx(B,{onReportGenerated:f,selectedCenter:l}),a&&e.jsx(E,{type:a.type,data:a.data}),!a&&e.jsxs("div",{className:"bg-white p-12 rounded-lg shadow-md text-center",children:[e.jsx(L,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Select a report type and click generate to view data."})]})]})})};export{U as default};
